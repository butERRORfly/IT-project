import{r as g,R as v,a as b}from"./assets/client-D1U2EYe0.js";const S=e=>new Promise(r=>setTimeout(r,e)),$=e=>(e==null?void 0:e.split(" ")[1])||"",A=()=>({getDataByRegion:async(r,i)=>{try{const a="17EMDDSCAKIF",u="https://cors-anywhere.herokuapp.com/",l=`http://api.timezonedb.com/v2.1/get-time-zone?key=${a}&format=json&by=position&lat=${r}&lng=${i}`,n=await(await fetch(l)).json();return await S(2e3),n}catch(a){return console.error("Error during data retrieval:",a),null}},spliter:$}),D=({validator:e,onTimeDataUpdate:r})=>{const{getDataByRegion:i,spliter:a}=A();return g.useEffect(()=>{if(!e||e.length===0){console.warn("Validator is empty");return}(async()=>{const l=[];for(let o=0;o<e.length;o++)try{if(e[o]===0){l.push({id:o,time:"00:00:00",error:"Geocoding failed"});continue}o>0&&await new Promise(d=>setTimeout(d,800));const n=await i(e[o][0],e[o][1]);console.log("Raw API response:",n);let m="00:00:00",p=null;n!=null&&n.formatted?m=a(n.formatted):n!=null&&n.time?m=n.time:p="Invalid response structure",/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]$/.test(m)||(p="Invalid time format",m="00:00:00"),l.push({id:o,time:m,error:p})}catch(n){console.error(`Error processing point ${o}:`,n),l.push({id:o,time:"00:00:00",error:"API request failed"})}console.log("Final results:",l),r(l)})()},[e]),null};function C({locations:e,connectionTypes:r,onTimeDataUpdate:i}){const[a,u]=g.useState([]);return g.useEffect(()=>{if(!window.ymaps)return;r.pop();const l=()=>{const o=new window.ymaps.Map("map",{center:[55.76,37.64],zoom:3,controls:["zoomControl","searchControl"]}),n=[],m=t=>{console.log("Setting validator:",t),u(t)},p=t=>new Promise((c,s)=>{window.ymaps.geocode(t).then(f=>{const h=f.geoObjects.get(0);if(h){const w=h.geometry.getCoordinates();console.log(`Geocoded ${t}:`,w),c(w)}else s(`–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –¥–ª—è ${t}`)},f=>{console.error(`Geocoding failed for ${t}:`,f),s(`–û—à–∏–±–∫–∞ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –∞–¥—Ä–µ—Å–∞: ${t}, ${f}`)})}),d=(t,c)=>{if(t&&c){const s=new ymaps.multiRouter.MultiRoute({referencePoints:[t,c],params:{routingMode:"auto"}},{boundsAutoApply:!0});o.geoObjects.add(s),s.model.events.add("requestsuccess",function(){const R=s.getActiveRoute();try{const f=R.properties.get("distance").value}catch{y(t,c)}})}else console.error("–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç, —Ç–∞–∫ –∫–∞–∫ –æ–¥–Ω–∞ –∏–∑ —Ç–æ—á–µ–∫ –Ω–µ –∏–º–µ–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç.")},y=(t,c)=>{if(t&&c){const s=new ymaps.Polyline([t,c],{hintContent:"–õ–∏–Ω–∏—è –º–µ–∂–¥—É —Ç–æ—á–∫–∞–º–∏"},{strokeColor:"#0000FF",strokeWidth:4,strokeOpacity:.7});o.geoObjects.add(s)}else console.error("–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–ª–∏–ª–∏–Ω–∏—é, —Ç–∞–∫ –∫–∞–∫ –æ–¥–Ω–∞ –∏–∑ —Ç–æ—á–µ–∫ –Ω–µ –∏–º–µ–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç.")};if(e.length>1)for(let t=0;t<e.length-1;t++){const c=e[t],s=e[t+1],R=r[t];c&&s?R==="car"?d(c,s):R==="poliline"&&y(c,s):console.error("–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç, —Ç–∞–∫ –∫–∞–∫ –æ–¥–Ω–∞ –∏–∑ —Ç–æ—á–µ–∫ –Ω–µ –∏–º–µ–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç.")}else console.error("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç–æ—á–µ–∫ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–∞");let E=Promise.resolve();e.forEach(t=>{E=E.then(()=>p(t)).then(c=>{n.push(c);const s=new window.ymaps.Placemark(c,{balloonContent:t});o.geoObjects.add(s)}).catch(c=>{console.error("Error in geocoding chain:",c),n.push(0),console.error("Geocoding error for location:",t,c)})}),E.finally(()=>{console.log("All geocoding completed, tempValidator:",n),m(n)})};window.ymaps.ready(l)},[e,r]),React.createElement(React.Fragment,null,React.createElement("div",{id:"map",style:{width:"100%",height:"400px"}}),React.createElement(D,{validator:a,onTimeDataUpdate:i}))}function _(e){const[r,i]=g.useState(e);return g.useEffect(()=>{if(i(e),!e||e==="00:00:00")return;const a=setInterval(()=>{i(u=>{const[l,o,n]=u.split(":").map(Number);let m=n+1,p=o,d=l;return m>=60&&(m=0,p+=1),p>=60&&(p=0,d+=1),d>=24&&(d=0),`${String(d).padStart(2,"0")}:${String(p).padStart(2,"0")}:${String(m).padStart(2,"0")}`})},1e3);return()=>clearInterval(a)},[e]),r}function I({data:e,timeData:r=[]}){return React.createElement("div",{className:"sidebar"},e.loc.map((i,a)=>{const u=r.find(o=>o.id===a)||{},l=u.time?_(u.time):"Loading time in point...";return React.createElement("div",{class:"route-point",key:`point-${a}`},React.createElement("div",{class:"point-header"},React.createElement("h3",null,"üìç ",i,React.createElement("p",{className:`rater-${a} time-displayer`,style:{color:u.error?"red":"inherit"}},"‚è∞ ",u.error||l)),React.createElement("span",{class:"badge"},e.wait[a])),React.createElement("div",null,"–°–ø–æ—Å–æ–± –ø–µ—Ä–µ–¥–≤–∏–∂–µ–Ω–∏—è - ",e.typic[a]),React.createElement("div",{class:"point-dates"},React.createElement("div",null,React.createElement("span",{class:"label"},"–ü—Ä–∏–±—ã—Ç–∏–µ:"),React.createElement("span",{class:"value"},e.date_to[a])),React.createElement("div",null,React.createElement("span",{class:"label"},"–û—Ç–±—ã—Ç–∏–µ:"),React.createElement("span",{class:"value"},e.date_out[a]))),React.createElement("div",{class:"hotel-label"},React.createElement("span",{class:"label"},"–ì–æ—Å—Ç–∏–Ω–∏—Ü–∞:"),React.createElement("span",{class:"value"},e.gost[a])),React.createElement("div",{class:"point-price"},React.createElement("span",{class:"label"},"–°—Ç–æ–∏–º–æ—Å—Ç—å:"),React.createElement("span",{class:"value"},e.cost[a])),React.createElement("a",{href:e.rec[a],class:"booking-btn"},"–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –≥–æ—Å—Ç–∏–Ω–∏—Ü—É ‚Üí"))}))}const M=({src:e})=>(g.useEffect(()=>{const r=document.createElement("script");return r.src=e,r.async=!0,document.body.appendChild(r),()=>{document.body.removeChild(r)}},[e]),null);function T({totalScore:e}){return React.createElement("div",{class:"summ-price"},React.createElement("div",null,React.createElement("span",{class:"label"},"üíµ –ü–æ–ª–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:"),React.createElement("p2",{id:"rater"},"USD"),React.createElement("span",{id:"summary",class:"value"},e)),React.createElement("select",{id:"selector",class:"select-container"}),React.createElement(M,{src:"/src/adapters/entrypoints/static/rate.js"}))}function k(){return React.createElement("button",{className:"fixed-button"},"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ")}function P({data:e}){const[r,i]=g.useState([]);return!e||!Array.isArray(e.loc)?React.createElement("div",{className:"error-message"},"–î–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–ª–∏ –∏–º–µ—é—Ç –Ω–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç"):React.createElement("div",{className:"map-page"},React.createElement(C,{locations:e.loc,connectionTypes:e.typic,onTimeDataUpdate:i}),React.createElement("div",{className:"sidebar-grid"},React.createElement(T,{totalScore:e.total_score}),React.createElement("div",{className:"overlay-container"},React.createElement(I,{data:e,timeData:r}))),React.createElement(k,null))}const N=window.__REACT_DATA__||{loc:[],date_to:[],date_out:[],gost:[],wait:[],cost:[],rec:[],total_score:"0"},j=v.createRoot(document.getElementById("react-root"));j.render(b.createElement(P,{data:N}));
